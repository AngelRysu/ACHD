{% extends 'layout.html' %}

{% block title %}Docentes{% endblock %}

{% block css %}

<script src="https://kit.fontawesome.com/80905f653a.js" crossorigin="anonymous"></script>

<style>
    .principal {
        display: flex;
        flex-direction: row;
        flex-wrap: wrap;
    }

    .seccion {
        display: flex;
        flex-direction: column;
        width: 30%;
        gap: 3rem;
    }

    .subseccion {
        width: 100%;
    }

    .docente {
        padding: 0.8rem;
        background: white;
        color: black;
        border-radius: 0.5rem;
        margin: 0.9rem;
        max-width: 25rem;
        text-decoration: none;
    }

    .boton i {
        font-size: 5rem;
    }

    .boton:hover {
        transition: ease .3s;
        background: #a98bf5;
    }

    .docentes {
        margin: 1rem;
        max-height: 75vh;
        overflow-y: auto;
    }

    .docentes::-webkit-scrollbar {
        width: 9px;
    }

    .boton {
        background: rgb(168, 187, 241);
        padding: 2rem;
        border-radius: 1rem;
        display: flex;
        font-size: 1.2rem;
        flex-direction: column;
        align-items: center;
        justify-content: center;
        text-align: center;
        font-family: 'Montserrat', sans-serif;
        width: 90%;
        text-decoration: none;
        color: black;
    }


    #contenedor iframe {
        height: 80vh;
        /* Establece la altura del iframe igual al alto de la ventana del navegador */
        width: 100vh;
        /* Ocupa todo el ancho disponible */
        border: none;
        /* Sin borde para el iframe */
        overflow: hidden;
        /* Oculta el contenido que exceda el tamaño del iframe */
    }

    .exportbtn {
        width: 120px;
        height: 40px;
        margin-left: 10px;
        margin-right: 10px;
        border-radius: 15px;
        transition: .5s;
        position: fixed;
        bottom: 10px;
        right: 10px;
        z-index: 9999;
    }

    .exportbtn:hover {
        background-color: #37109b;
        border: none;
        color: white;
    }
</style>


{% endblock %}

{% block body_class %}inicio{% endblock %}



{% block content %}


<div class="principal">

    <div class="seccion">

        <div class="docentes">

            {% for docente in docentes %}
            {% set useridINT = userid | int %}
            <div class="docente"
                style="background: {% if useridINT == docente.usuario.id %}#37109b;{% else %}white;{% endif %}; color: {% if useridINT == docente.usuario.id %}white;{% else %}black;{% endif %}">
                <a style="text-decoration: none; color: {% if useridINT == docente.usuario.id %}white;{% endif %}"
                    href="?userid={{ docente.usuario.id }}">
                    <p>{{ docente.usuario.nombre }} {{ docente.usuario.apellido_pat }} {{ docente.usuario.apellido_mat
                        }}</p>
                </a>
            </div>
            {% endfor %}


        </div>

        <button class="exportbtn" id="exportarBtn">Disponibilidad</button>

    </div>



    <div class="seccion" style="text-align: center; align-items: center;width: 70%">

        <div class="subseccion" style="height: 40rem;">
            <h2 style="color: white;">Horario del docente</h2>

            <div id="contenedor">
                <iframe src="/horarioJ?userid={{ userid }}"></iframe>
            </div>


        </div>


    </div>


</div>


<script>
    document.addEventListener('DOMContentLoaded', function () {
        document.getElementById('exportarBtn').addEventListener('click', function () {
            fetch('/export/disponibilidades', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify({
                    // Aquí puedes agregar cualquier dato adicional que desees enviar al servidor
                })
            })
                .then(response => {
                    if (response.ok) {
                        return response.blob();  // Convertir la respuesta a blob
                    } else {
                        throw new Error('Error al exportar datos');
                    }
                })
                .then(blob => {
                    const url = window.URL.createObjectURL(blob);
                    const a = document.createElement('a');
                    a.style.display = 'none';
                    a.href = url;
                    a.download = 'exportacion_grupos.xlsx';  // El nombre del archivo
                    document.body.appendChild(a);
                    a.click();
                    window.URL.revokeObjectURL(url);
                })
                .catch(error => {
                    console.error('Error al exportar datos:', error);
                });
        });
    });
</script>



{% endblock %}